(this["webpackJsonpmy-react-app"]=this["webpackJsonpmy-react-app"]||[]).push([[0],{37:function(e,t,a){},38:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a.n(n),c=a(16),r=a.n(c),i=a(14),o=a(4),l=a(43),d=a(21),j=a(20),p=a.n(j),b=a(5);var u=()=>{const[e,t]=Object(n.useState)(!1),[a,s]=Object(n.useState)(null),[c,r]=Object(n.useState)(null),[i,j]=Object(n.useState)([]),[u,h]=Object(n.useState)([]),x=Object(o.p)();Object(n.useEffect)((()=>{(async()=>{try{const e=await l.a.get("/api/check_login/");if(t(e.data.is_logged_in),e.data.is_logged_in){const e=await l.a.get("/api/user_info/");console.log("User Info:",e.data),r(e.data),g(),m(),O(),y()}}catch(e){console.error("\ub85c\uadf8\uc778 \uc0c1\ud0dc \ud655\uc778 \uc911 \uc624\ub958 \ubc1c\uc0dd:",e)}})(),(async()=>{try{const e=await l.a.get("/api/csrf_token/");s(e.data.csrfToken)}catch(e){console.error("CSRF \ud1a0\ud070\uc744 \uac00\uc838\uc624\ub294 \uc911 \uc624\ub958 \ubc1c\uc0dd:",e)}})();const a=setInterval((()=>{e&&(O(),y())}),6e5);return()=>clearInterval(a)}),[e]);const g=async()=>{try{const e=await l.a.get("/api/get_status/");j(e.data.statuses),v(e.data.statuses)}catch(e){console.error("\uc0ac\uc6a9\uc790 \uc0c1\ud0dc\ub97c \uac00\uc838\uc624\ub294 \uc911 \uc624\ub958 \ubc1c\uc0dd:",e)}},O=async()=>{try{await l.a.post("/api/update_status/",{},{headers:{"X-CSRFToken":a||""}});g()}catch(e){console.error("\uc0ac\uc6a9\uc790 \uc0c1\ud0dc\ub97c \uac31\uc2e0\ud558\ub294 \uc911 \uc624\ub958 \ubc1c\uc0dd:",e)}},m=async()=>{try{const e=await l.a.get("/api/get_posture/");h(e.data.postures),w(e.data.postures)}catch(e){console.error("\uc0ac\uc6a9\uc790 \uc790\uc138\ub97c \uac00\uc838\uc624\ub294 \uc911 \uc624\ub958 \ubc1c\uc0dd:",e)}},y=async()=>{try{await l.a.post("/api/update_posture/",{},{headers:{"X-CSRFToken":a||""}});m()}catch(e){console.error("\uc0ac\uc6a9\uc790 \uc790\uc138\ub97c \uac31\uc2e0\ud558\ub294 \uc911 \uc624\ub958 \ubc1c\uc0dd:",e)}},v=e=>{const t=document.getElementById("main");if(!t)return;const a=d.a(t),n=e.sort(((e,t)=>new Date(e.updated_at).getTime()-new Date(t.updated_at).getTime())),s={title:{text:"User Status Over Time"},tooltip:{trigger:"axis",formatter:e=>{const t=1===e[0].data[1]?"\uc815\uc0c1":2===e[0].data[1]?"\uc8fc\uc758":"\uc704\ud5d8";return"".concat(e[0].data[0],"<br/>\uc0c1\ud0dc: ").concat(t)}},xAxis:{type:"category",data:n.map((e=>p()(e.updated_at).format("MM-DD HH:mm:ss")))},yAxis:{type:"value"},series:[{data:n.map((e=>[p()(e.updated_at).format("MM-DD HH:mm:ss"),e.status])),type:"line",lineStyle:{color:"#5470C6"},itemStyle:{color:e=>1===e.data[1]?"green":2===e.data[1]?"yellow":"red",borderWidth:2},symbolSize:10,symbol:"circle"}]};a.setOption(s)},w=e=>{const t=document.getElementById("posture");if(!t)return;const a=d.a(t),n=e.sort(((e,t)=>new Date(e.updated_at).getTime()-new Date(t.updated_at).getTime())),s={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:e=>{const t=e[0].data[1];return"".concat(e[0].data[0],"<br/>\uc790\uc138: ").concat(["Downstair","Upstair","Running","Sitdown","StandUp","Walking","Fall"][t])}},legend:{},grid:{left:"3%",right:"4%",bottom:"70%",containLabel:!0},xAxis:{type:"value"},yAxis:{type:"category",data:["posture"]},series:["Downstair","Upstair","Running","Sitdown","StandUp","Walking","Fall"].map(((e,t)=>({name:e,type:"bar",stack:"total",label:{show:!0},emphasis:{focus:"series"},data:n.map((e=>e.posture===t?1:0))})))};a.setOption(s)};return Object(b.jsxs)("div",{children:[Object(b.jsx)("div",{style:{display:"flex",justifyContent:"flex-end",padding:"10px"},children:e?Object(b.jsx)("button",{onClick:async()=>{try{await l.a.post("/api/logout/",{},{headers:{"X-CSRFToken":a||""}}),t(!1),x("/login")}catch(e){console.error("\ub85c\uadf8\uc544\uc6c3 \uc911 \uc624\ub958 \ubc1c\uc0dd:",e)}},style:{marginLeft:"10px"},children:"Logout"}):Object(b.jsxs)(b.Fragment,{children:[Object(b.jsx)("button",{onClick:()=>x("/login"),style:{marginLeft:"10px"},children:"Login"}),Object(b.jsx)("button",{onClick:()=>x("/register"),style:{marginLeft:"10px"},children:"Register"})]})}),Object(b.jsx)("div",{style:{textAlign:"center",marginTop:"20px"},children:e&&c?Object(b.jsxs)("h1",{children:[c.name,"\ub2d8 (",c.age,"\uc138), \ud604\uc7ac \uc6f9\uc5d0 \uc811\uc18d\ud558\uc168\uc2b5\ub2c8\ub2e4!"]}):Object(b.jsx)("h1",{children:"Welcome to the Main Page"})}),Object(b.jsx)("div",{id:"main",style:{width:"100%",height:"400px"}}),Object(b.jsx)("div",{id:"posture",style:{width:"100%",height:"400px",marginTop:"20px"}})]})},h=a(11);var x=()=>{const[e,t]=Object(n.useState)(null),[a,s]=Object(n.useState)({id:"",password:"",name:"",age:"",address:"",detailed_address:"",phone_num:"",guard_name:"",guard_phone_num:""}),[c,r]=Object(n.useState)([]),[i,d]=Object(n.useState)(!1),j=Object(o.p)();Object(n.useEffect)((()=>{(async()=>{const e=await l.a.get("/api/csrf_token/");t(e.data.csrfToken)})()}),[]);const p=e=>{s(Object(h.a)(Object(h.a)({},a),{},{[e.target.name]:e.target.value})),"id"===e.target.name&&d(!1)};return Object(b.jsxs)("div",{children:[Object(b.jsx)("button",{onClick:()=>j(-1),children:"Back"})," ",Object(b.jsx)("h1",{children:"\ud68c\uc6d0\uac00\uc785"}),Object(b.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),r([]),i)try{const t=await l.a.post("/api/signup/",a,{headers:{"Content-Type":"application/json","X-CSRFToken":e||""}});console.log("\ud68c\uc6d0\uac00\uc785 \uc131\uacf5:",t.data),j("/login")}catch(n){n.response&&n.response.data?r([n.response.data.message]):r(["\ud68c\uc6d0\uac00\uc785 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4."])}else r(["ID \uc911\ubcf5 \uac80\uc0ac\ub97c \uc644\ub8cc\ud574\uc8fc\uc138\uc694."])},children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{children:"ID:"}),Object(b.jsx)("input",{type:"text",name:"id",value:a.id,onChange:p}),Object(b.jsx)("button",{type:"button",onClick:async()=>{try{(await l.a.post("/api/check_id/",{id:a.id},{headers:{"Content-Type":"application/json","X-CSRFToken":e||""}})).data.isAvailable?(alert("\uc0ac\uc6a9 \uac00\ub2a5\ud55c ID\uc785\ub2c8\ub2e4."),d(!0)):(alert("\uc774\ubbf8 \uc0ac\uc6a9 \uc911\uc778 ID\uc785\ub2c8\ub2e4."),d(!1))}catch(t){console.error("ID \uc911\ubcf5 \uac80\uc0ac \uc911 \uc624\ub958 \ubc1c\uc0dd:",t),d(!1)}},children:"\uc911\ubcf5 \uac80\uc0ac"})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{children:"Password:"}),Object(b.jsx)("input",{type:"password",name:"password",value:a.password,onChange:p})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{children:"Name:"}),Object(b.jsx)("input",{type:"text",name:"name",value:a.name,onChange:p})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{children:"Age:"}),Object(b.jsx)("input",{type:"text",name:"age",value:a.age,onChange:p})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{children:"Address:"}),Object(b.jsx)("input",{type:"text",name:"address",value:a.address,onChange:p})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{children:"Detailed Address:"}),Object(b.jsx)("input",{type:"text",name:"detailed_address",value:a.detailed_address,onChange:p})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{children:"Phone Number:"}),Object(b.jsx)("input",{type:"text",name:"phone_num",value:a.phone_num,onChange:p})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{children:"Guard Name:"}),Object(b.jsx)("input",{type:"text",name:"guard_name",value:a.guard_name,onChange:p})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{children:"Guard Phone Number:"}),Object(b.jsx)("input",{type:"text",name:"guard_phone_num",value:a.guard_phone_num,onChange:p})]}),Object(b.jsx)("button",{type:"submit",children:"\ub4f1\ub85d"}),Object(b.jsx)("button",{type:"button",onClick:()=>j("/login"),children:"\ub85c\uadf8\uc778"})]}),c.length>0&&Object(b.jsx)("div",{style:{color:"red"},children:c.map(((e,t)=>Object(b.jsx)("p",{children:e},t)))})]})};var g=()=>{const[e,t]=Object(n.useState)(null),[a,s]=Object(n.useState)(""),[c,r]=Object(n.useState)(""),i=Object(o.p)();Object(n.useEffect)((()=>{(async()=>{try{const e=await l.a.get("/api/csrf_token/");t(e.data.csrfToken)}catch(e){console.error("CSRF \ud1a0\ud070\uc744 \uac00\uc838\uc624\ub294 \uc911 \uc624\ub958 \ubc1c\uc0dd:",e)}})()}),[]);return Object(b.jsxs)("div",{children:[Object(b.jsx)("button",{onClick:()=>i(-1),children:"Back"})," ",Object(b.jsx)("h1",{children:"Login"}),Object(b.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{const t=await l.a.post("/api/login/",{id:a,password:c},{headers:{"X-CSRFToken":e||""}});console.log("\ub85c\uadf8\uc778 \uc131\uacf5:",t.data),window.location.href="/"}catch(n){console.error("\ub85c\uadf8\uc778 \uc911 \uc624\ub958 \ubc1c\uc0dd:",n)}},children:[Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{children:"ID:"}),Object(b.jsx)("input",{type:"text",value:a,onChange:e=>s(e.target.value)})]}),Object(b.jsxs)("div",{children:[Object(b.jsx)("label",{children:"Password:"}),Object(b.jsx)("input",{type:"password",value:c,onChange:e=>r(e.target.value)})]}),Object(b.jsx)("button",{type:"submit",children:"\ub85c\uadf8\uc778"}),Object(b.jsx)("button",{type:"button",onClick:()=>i("/register"),children:"\ud68c\uc6d0\uac00\uc785"})]})]})};var O=()=>Object(b.jsx)(i.a,{children:Object(b.jsxs)(o.c,{children:[Object(b.jsx)(o.a,{path:"/",element:Object(b.jsx)(u,{})}),Object(b.jsx)(o.a,{path:"/register",element:Object(b.jsx)(x,{})}),Object(b.jsx)(o.a,{path:"/login",element:Object(b.jsx)(g,{})})]})});a(37);r.a.render(Object(b.jsx)(s.a.StrictMode,{children:Object(b.jsx)(O,{})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.ac116229.chunk.js.map