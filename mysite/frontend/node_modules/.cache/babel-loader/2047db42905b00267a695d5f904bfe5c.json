{"ast":null,"code":"import _objectSpread from\"/home/azureuser/Desktop/son/safety-detection/mysite/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{useNavigate}from'react-router-dom';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Register=()=>{const[csrfToken,setCsrfToken]=useState(null);const[formData,setFormData]=useState({id:'',password:'',name:'',age:'',address:'',detailed_address:'',phone_num:'',guard_name:'',guard_phone_num:''});const[errors,setErrors]=useState([]);const[isIdChecked,setIsIdChecked]=useState(false);const navigate=useNavigate();useEffect(()=>{const fetchCsrfToken=async()=>{const response=await axios.get('/api/csrf_token/');setCsrfToken(response.data.csrfToken);};fetchCsrfToken();},[]);const handleChange=e=>{setFormData(_objectSpread(_objectSpread({},formData),{},{[e.target.name]:e.target.value}));if(e.target.name==='id'){setIsIdChecked(false);// ID가 변경되면 중복 검사 상태를 초기화\n}};const handleIdCheck=async()=>{try{const response=await axios.post('/api/check_id/',{id:formData.id},{headers:{'Content-Type':'application/json','X-CSRFToken':csrfToken||''}});if(response.data.isAvailable){alert('사용 가능한 ID입니다.');setIsIdChecked(true);}else{alert('이미 사용 중인 ID입니다.');setIsIdChecked(false);}}catch(error){console.error('ID 중복 검사 중 오류 발생:',error);setIsIdChecked(false);}};const handleSubmit=async e=>{e.preventDefault();setErrors([]);if(!isIdChecked){setErrors(['ID 중복 검사를 완료해주세요.']);return;}try{const response=await axios.post('/api/signup/',formData,{headers:{'Content-Type':'application/json','X-CSRFToken':csrfToken||''}});console.log('회원가입 성공:',response.data);navigate('/login');}catch(error){if(error.response&&error.response.data){setErrors([error.response.data.message]);}else{setErrors(['회원가입 중 오류가 발생했습니다.']);}}};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{children:\"\\uD68C\\uC6D0\\uAC00\\uC785\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"ID:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"id\",value:formData.id,onChange:handleChange}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:handleIdCheck,children:\"\\uC911\\uBCF5 \\uAC80\\uC0AC\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Password:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",value:formData.password,onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Name:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",value:formData.name,onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Age:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"age\",value:formData.age,onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Address:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"address\",value:formData.address,onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Detailed Address:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"detailed_address\",value:formData.detailed_address,onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Phone Number:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"phone_num\",value:formData.phone_num,onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Guard Name:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"guard_name\",value:formData.guard_name,onChange:handleChange})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Guard Phone Number:\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"guard_phone_num\",value:formData.guard_phone_num,onChange:handleChange})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",children:\"Register\"})]}),errors.length>0&&/*#__PURE__*/_jsx(\"div\",{style:{color:'red'},children:errors.map((error,index)=>/*#__PURE__*/_jsx(\"p\",{children:error},index))})]});};export default Register;","map":{"version":3,"names":["React","useState","useEffect","useNavigate","axios","jsx","_jsx","jsxs","_jsxs","Register","csrfToken","setCsrfToken","formData","setFormData","id","password","name","age","address","detailed_address","phone_num","guard_name","guard_phone_num","errors","setErrors","isIdChecked","setIsIdChecked","navigate","fetchCsrfToken","response","get","data","handleChange","e","_objectSpread","target","value","handleIdCheck","post","headers","isAvailable","alert","error","console","handleSubmit","preventDefault","log","message","children","onSubmit","type","onChange","onClick","length","style","color","map","index"],"sources":["/home/azureuser/Desktop/son/safety-detection/mysite/frontend/src/components/Register.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport axios from 'axios';\n\nconst Register = () => {\n  const [csrfToken, setCsrfToken] = useState<string | null>(null);\n  const [formData, setFormData] = useState({\n    id: '',\n    password: '',\n    name: '',\n    age: '',\n    address: '',\n    detailed_address: '',\n    phone_num: '',\n    guard_name: '',\n    guard_phone_num: ''\n  });\n  const [errors, setErrors] = useState<string[]>([]);\n  const [isIdChecked, setIsIdChecked] = useState(false);\n  const navigate = useNavigate();\n\n  useEffect(() => {\n    const fetchCsrfToken = async () => {\n      const response = await axios.get('/api/csrf_token/');\n      setCsrfToken(response.data.csrfToken);\n    };\n    fetchCsrfToken();\n  }, []);\n\n  const handleChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setFormData({\n      ...formData,\n      [e.target.name]: e.target.value\n    });\n    if (e.target.name === 'id') {\n      setIsIdChecked(false); // ID가 변경되면 중복 검사 상태를 초기화\n    }\n  };\n\n  const handleIdCheck = async () => {\n    try {\n      const response = await axios.post('/api/check_id/', { id: formData.id }, {\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': csrfToken || ''\n        }\n      });\n      if (response.data.isAvailable) {\n        alert('사용 가능한 ID입니다.');\n        setIsIdChecked(true);\n      } else {\n        alert('이미 사용 중인 ID입니다.');\n        setIsIdChecked(false);\n      }\n    } catch (error) {\n      console.error('ID 중복 검사 중 오류 발생:', error);\n      setIsIdChecked(false);\n    }\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setErrors([]);\n    if (!isIdChecked) {\n      setErrors(['ID 중복 검사를 완료해주세요.']);\n      return;\n    }\n    try {\n      const response = await axios.post('/api/signup/', formData, {\n        headers: {\n          'Content-Type': 'application/json',\n          'X-CSRFToken': csrfToken || ''\n        }\n      });\n      console.log('회원가입 성공:', response.data);\n      navigate('/login');\n    } catch (error: any) {\n      if (error.response && error.response.data) {\n        setErrors([error.response.data.message]);\n      } else {\n        setErrors(['회원가입 중 오류가 발생했습니다.']);\n      }\n    }\n  };\n\n  return (\n    <div>\n      <h1>회원가입</h1>\n      <form onSubmit={handleSubmit}>\n        <div>\n          <label>ID:</label>\n          <input type=\"text\" name=\"id\" value={formData.id} onChange={handleChange} />\n          <button type=\"button\" onClick={handleIdCheck}>중복 검사</button>\n        </div>\n        <div>\n          <label>Password:</label>\n          <input type=\"password\" name=\"password\" value={formData.password} onChange={handleChange} />\n        </div>\n        <div>\n          <label>Name:</label>\n          <input type=\"text\" name=\"name\" value={formData.name} onChange={handleChange} />\n        </div>\n        <div>\n          <label>Age:</label>\n          <input type=\"text\" name=\"age\" value={formData.age} onChange={handleChange} />\n        </div>\n        <div>\n          <label>Address:</label>\n          <input type=\"text\" name=\"address\" value={formData.address} onChange={handleChange} />\n        </div>\n        <div>\n          <label>Detailed Address:</label>\n          <input type=\"text\" name=\"detailed_address\" value={formData.detailed_address} onChange={handleChange} />\n        </div>\n        <div>\n          <label>Phone Number:</label>\n          <input type=\"text\" name=\"phone_num\" value={formData.phone_num} onChange={handleChange} />\n        </div>\n        <div>\n          <label>Guard Name:</label>\n          <input type=\"text\" name=\"guard_name\" value={formData.guard_name} onChange={handleChange} />\n        </div>\n        <div>\n          <label>Guard Phone Number:</label>\n          <input type=\"text\" name=\"guard_phone_num\" value={formData.guard_phone_num} onChange={handleChange} />\n        </div>\n        <button type=\"submit\">Register</button>\n      </form>\n      {errors.length > 0 && (\n        <div style={{ color: 'red' }}>\n          {errors.map((error, index) => (\n            <p key={index}>{error}</p>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Register;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}